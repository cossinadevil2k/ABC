<div class='module no-padding'>
	<div class="module-header">
		<div class="row">
			<div class="function-left">
				<a href="/users" class="btn btn-default"><i class="icon-reply"></i> Back</a>
			</div>
			<div class="function-right">
				<button class="btn btn-primary hidden-xs" ng-click="showNotif()"><i class=" icon-bullhorn"></i> Notification history</button>
				<button class="btn btn-success hidden-xs" ng-click="showUserInfo(userInfo)"><i class="icon icon-info"></i> User info</button>
				<button class="btn btn-orange hidden-xs" ng-click="showIssues(userInfo)"><i class="icon icon-thumbs-down"></i> Helpdesk issues</button>
				<button class="btn hidden-xs" ng-class="{'btn-twitter': !userInfo.customerSupport, 'btn-primary': userInfo.customerSupport}" ng-click="changeCustomerSupport(userInfo)">
					<i class="icon icon-magic"></i> Customer Support: {{userInfo.customerSupport ? 'ON' : 'OFF'}}
				</button>
				<div class="btn-group menu-three-dot">
					<button data-toggle="dropdown"><i class="icon-ellipsis-vertical" style="font-size: 1.5em !important;"></i></button>
					<ul class="dropdown-menu pull-right">
						<li><a href="#" ng-click="acceptPurchased(userInfo)"><i class="icon icon-money"></i> Set premium</a></li>
						<li><a href="#" ng-click="iconGift(userInfo)"><i class="icon icon-gift"></i> Send gift</a></li>
						<li><a href="#" ng-click="showDevice(userInfo._id)"><i class="icon icon-mobile-phone"></i> Show devices</a></li>
						<li><a href="#" ng-click="changeLimitDevice(userInfo)"><i class="icon icon-sort-by-order"></i> Change device limit</a></li>
						<li><a href="#" ng-click="addExpire(userInfo)"><i class="icon icon-calendar"></i> Extend subscription expire</a></li>
						<li><a href="#" ng-click="manualTag(userInfo)"><i class="icon icon-tags"></i> Manual tags</a></li>
						<li><a href="#" ng-click="discountSetting(userInfo)"><i class="icon icon-sort-down"></i> Discount</a></li>
						<li><a href="#" ng-click="sendMessage(userInfo)"><i class="icon icon-comment"></i> Message to user</a></li>
						<li><a href="#" ng-click="showReceipt(userInfo)"><i class="icon icon-file"></i> Receipts</a></li>
						<li><a href="#" ng-click="restoreCredit(userInfo)"><i class="icon icon-bitcoin"></i> Restore Credit</a></li>						
						<li><a href="#" ng-click="purchase_history(userInfo)"><i class="icon icon-credit-card"></i> Purchase log</a></li>
						<li><a href="#" ng-click="finsifyDetail(userInfo)"><i class="icon icon-dollar"></i> Finsify Info</a></li>
						<li><a href="#" ng-click="reactiveFinsifyManual(userInfo)"><i class="icon icon-magic"></i> Reactive Finsify Manual</a></li>						
						<li>
							<a href="#" ng-click="changeActivateStatus(userInfo)">
								<i class="icon" ng-class="{'icon-lock': !userInfo.isDeactivated, 'icon-unlock': userInfo.isDeactivated}"></i> {{userInfo.isDeactivated ? 'Activate' : 'Deactivate'}}
							</a>
						</li>

						<li><a href="#" class="hidden-sm hidden-md hidden-lg" ng-click="showUserInfo(userInfo)"><i class="icon icon-info"></i> User info</a></li>
						<li><a href="#" class="hidden-sm hidden-md hidden-lg" ng-click="showIssues(userInfo)"><i class="icon icon-thumbs-down"></i> Helpdesk issues</a></li>
						<li><a href="#" class="hidden-sm hidden-md hidden-lg" ng-click="changeSkipPass(userInfo)"><i class="icon icon-magic"></i> Skip password: {{userInfo.skipPassword ? 'ON' : 'OFF'}}</a></li>
					</ul>
				</div>
			</div>
		</div>
	</div>

	<loading ng-if="isLoading"></loading>
	<div class='module-content'>
		<div class="module" style="overflow-x: auto;">
			<div class="module-header no-padding">
				<ul id="myTab" class="nav nav-tabs" style="background-color: #505962">
					<li><a href="#" ng-click="selectTab('working')" ng-class="{'active': tabSelected=='working'}">Wallet</a></li>
					<li><a href="#" ng-click="selectTab('deleted')" ng-class="{'active': tabSelected=='deleted'}">Wallet deleted</a></li>
					<li><a href="#" ng-click="selectTab('campaign')" ng-class="{'active': tabSelected=='campaign'}">Campaign</a></li>
				</ul>
			</div>
			<div class="module-content no-padding">
				<table class="table table-striped">
					<thead ng-if="tabSelected=='working' || tabSelected=='deleted'">
					<tr>
						<th></th>
						<th>Name</th>
						<th>Currency</th>
						<th>Balance</th>
						<th>Type</th>
						<th>Create At</th>
						<th class="text-right">Action</th>
					</tr>
					</thead>
					<thead ng-if="tabSelected=='campaign'">
					<tr>
						<th></th>
						<th>Name</th>
						<th>Currency</th>
						<th>Goal</th>
						<th>End date</th>
						<th>Last update</th>
						<th>Created At</th>
						<th class="text-right">Action</th>
					</tr>
					</thead>
					<tbody ng-if="tabSelected=='working'">
						<tr class="animate-repeat" ng-repeat="(key, wallet) in listWallet | filter:searchKeyword track by $index" ng-if="!wallet.isDelete">
							<td ng-if="!wallet.account_type"><img src="{{wallet.icon | walletIconLink}}" alt="{{ wallet.name }}" class="icon-user-wallet"/></td>
							<td ng-if="wallet.account_type"><img src="{{wallet.iconUrl}}" alt="{{ wallet.name }}" class="icon-user-wallet"/></td>
							<td style="vertical-align: middle"><a class="helpdesk-link" href="" ng-click="viewWalletDetails(wallet)">{{ wallet.name }}</a></td>
							<td style="vertical-align: middle">{{ wallet.currency_id | currency}}</td>
							<td ng-if="wallet.account_type" style="vertical-align: middle">{{ (wallet.balance || wallet.rwInfo.balance) | number}}</td>
							<td ng-if="!wallet.account_type" style="vertical-align: middle">{{ walletBalance[wallet._id].toString() || 'Loading'}}</td>
							<td style="vertical-align: middle">{{wallet.account_type | walletType}}</td>
							<td style="vertical-align: middle">{{ wallet.createdAt | checkDateTime }}</td>
							<td class="text-right">
								<a href="/wallet-diagnosis?walletid={{wallet._id}}" class="btn btn-facebook" tooltip="Diagnosis"><i class="icon-signal"></i></a>
								<button class="btn btn-info" tooltip="Make {{wallet.isPublic ? 'private' : 'public'}}" ng-click="togglePublicWallet(wallet)">
									<icon ng-class="{'icon-lock': wallet.isPublic, 'icon-unlock': !wallet.isPublic}"></icon>
								</button>
							</td>
						</tr>
					</tbody>
					<tbody ng-if="tabSelected=='deleted'">
						<tr ng-repeat="(key, wallet) in listWallet | filter:searchKeyword track by $index" ng-if="wallet.isDelete">
							<td><img src="{{wallet.icon | walletIconLink}}" alt="{{ wallet.name }}" class="icon-user-wallet"/></td>
							<td style="vertical-align: middle"><a class="helpdesk-link" href="" ng-click="viewWalletDetails(wallet)">{{ wallet.name }}</a></td>
							<td style="vertical-align: middle">{{ wallet.currency_id | currency }}</td>
							<td style="vertical-align: middle">{{ wallet.balance | number }}</td>
							<td style="vertical-align: middle">{{wallet.account_type | walletType}}</td>
							<td style="vertical-align: middle">{{ wallet.createdAt | checkDateTime }}</td>
							<td class="text-right">
								<a href="/wallet-diagnosis?walletid={{wallet._id}}" class="btn btn-facebook" tooltip="Diagnosis"><i class="icon-signal"></i></a>
								<button class="btn btn-twitter" ng-click="restoreWallet(wallet)" tooltip="Restore this wallet"><i class="icon icon-refresh"></i></button>
							</td>
						</tr>
					</tbody>
					<tbody ng-if="tabSelected=='campaign'">
						<tr ng-repeat="(key, campaign) in campaign_list | filter:searchKeyword track by $index">
							<td><img src="{{campaign.icon | walletIconLink}}" alt="{{ campaign.name }}" class="icon-user-wallet"/></td>
							<td>{{campaign.name}}</td>
							<td>{{campaign.currency_id | currency}}</td>
							<td>{{campaign.goal_amount}}</td>
							<td>{{campaign.end_date | checkDateTimeDateOnly}}</td>
							<td>{{campaign.updateAt | checkDateTime}}</td>
							<td>{{campaign.createdAt | checkDateTime}}</td>
							<td class="text-right">

							</td>
						</tr>
						<tr ng-if="!campaign_list">
							<td></td>
							<td>Global campaign not found</td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
							<td></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>
<script type="text/ng-template" id="alert.html">
	<div class="modal-header">
		<h4 class="modal-title">Notice</h4>
	</div>
	<div class="modal-body">
		<h4>Widget url:</h4>
		<div class="row">
			<input type="text" style="width: 75%" value="{{url}}">
			<a href="{{url}}" target="_blank" class="btn btn-primary">Open in new tab</a>
		</div>
	</div>
	<div class="modal-footer">
		<button class="btn btn-default" ng-click="cancel()">Close</button>
	</div>
</script>
